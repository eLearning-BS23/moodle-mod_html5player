define ("mod_html5player/brightcove",["jquery","core/ajax"],function(a,b){var c,d=function(a,b){var d=b.cmid,e=b.video_id;a.on("play",function(){console.info("Video started playing...");e=a.mediainfo.id;c=a.setInterval(function(){var b=Math.ceil(a.currentTime());console.log("Video playing. Total length: ".concat(a.duration(),". Video current progress is : ").concat(b));f(d,e,b)},+b.progress_interval)});a.on("pause",function(){a.clearInterval(c)});a.on("ended",function(){var b=Math.ceil(a.duration());console.log("Video ended...");f(d,e,b);a.clearInterval(c)})},e=function(a,b){window.require.config({paths:{bc:"https://players.brightcove.net/".concat(a,"/").concat(b,"_default/index.min")},waitSeconds:30})},f=function(a,c,d){var e=b.call([{methodname:"mod_html5player_set_module_progress",args:{id:a,videoid:c,progress:d}}]);e[0].then(function(a){console.info("Video completed : ".concat(a.completed))}).fail(function(a){console.log(a)})},g=function(a,c){var d;console.info("Geting course video progress from store...");d=b.call([{methodname:"mod_html5player_get_module_progress",args:{id:c.cmid,videoid:c.video_id}}]);d[0].then(function(b){console.info("Fetched result from store");var c=b.progress;if(c){var d=a.duration(),e=Math.floor(b.progress)/1e3;console.info("Duration is: ".concat(d," and Video progress is ").concat(e," seconds"));if(d>=e){a.currentTime(e)}else{a.currentTime(d-1)}}else{console.info("Video progress is ".concat(b.progress))}}).fail(function(a){console.log(a)})},h=function(a,c){var d;console.info("Getting course video progresses from store...");d=b.call([{methodname:"mod_html5player_get_module_progresses",args:{id:c.cmid}}]);d[0].then(function(a){console.info("Fetched module progresses result from store");console.log(a)}).fail(function(a){console.log(a)})},i=function(a,b){var c=b.cmid,d=b.video_id;a.on("loadedmetadata",function(){console.info("Single video player meta data loaded...");g(a,b)})},j=function(a,b){a.on("loadedmetadata",function(){console.info("playlist videos player meta data loaded...");h(a,b);a.playlist();a.playlist.currentItem()})},k=function(a,b){d(a,b)},l=function(a,b){d(a,b);a.on("beforeplaylistitem",function(){console.log("Event: beforeplaylistitem -> Switching to new video ...");a.clearInterval(c)})};return{init:function initBrightCovePlayer(a){a=JSON.parse(a);e(a.account_id,a.player_id);require(["bc"],function(){console.info("Brightcove player js loaded...");if(a.is_student){var b=videojs.getPlayer("brightcove-player-".concat(a.player_id));if(1==a.video_type){console.info("User is a student and Video type single video...");i(b,a);k(b,a)}else if(2==a.video_type){console.info("User is a student and Video type playlists video...");j(b,a);l(b,a)}}})}}});
//# sourceMappingURL=brightcove.min.js.map
