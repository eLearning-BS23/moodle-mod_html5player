{"version":3,"sources":["../src/brightcove.js"],"names":["define","$","Ajax","interval","loadBrightCoveJs","accountId","playerId","window","require","config","waitSeconds","set_course_module_progress","id","videoid","progress","promise","call","methodname","args","then","results","console","log","fail","e","html5playerOnLoadMetaData","player","on","playListsItems","playlist","forEach","item","index","html5playerOnPlay","course","cm","video_id","info","setInterval","currentTime","clearInterval","init","initBrightCovePlayer","myPlayer","videojs","getPlayer"],"mappings":"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","sourcesContent":["define(['jquery','core/ajax'], function ($, Ajax) {\n\n    let interval;\n\n    const loadBrightCoveJs = (accountId, playerId) => {\n        window.require.config({\n            'paths': {\n                'bc': `https://players.brightcove.net/${accountId}/${playerId}_default/index.min`\n            },\n            waitSeconds: 30\n        });\n    }\n\n    const set_course_module_progress = (id, videoid, progress) => {\n        let promise;\n\n        promise = Ajax.call([{\n            methodname: 'mod_html5player_set_module_progress',\n            args: {\n                id, // course module id.\n                videoid, // Brightcove video id.\n                progress, // Progress percentage\n            }\n        }]);\n\n        promise[0].then(function(results) {\n            console.log(results)\n\n        }).fail((e) => {\n            console.log(e)\n        });\n    }\n\n    // On Load meta data event and listener\n    const html5playerOnLoadMetaData = (player) => {\n        player.on('loadedmetadata', function(e){\n            // console.log(player.duration());\n            const playListsItems = player.playlist();\n            playListsItems.forEach( (item, index  ) => {\n                console.log(item);\n                console.log(index);\n            });\n        });\n    }\n\n\n    const html5playerOnPlay = (player,course, cm, video_id) => {\n        player.on('play',(e)=> {\n            console.info(`Video started playing...`)\n            interval = setInterval(function(){\n                const currentTime = player.currentTime();\n                console.log(`Video playing. Video current progress is : ${currentTime}`)\n                set_course_module_progress(cm,video_id,currentTime)\n            }, 5000);\n\n        })\n\n        player.on('pause',(e)=>{\n            clearInterval(interval);\n        })\n\n        player.on('ended',(e)=>{\n            const currentTime = player.currentTime();\n            console.log(`Video ended...`)\n            set_course_module_progress(cm,video_id,currentTime)\n            clearInterval(interval);\n        })\n\n        // player.on('stopped')\n    }\n\n    const initBrightCovePlayer = (course, cm, accountId, playerId, video_id) => {\n        // Make brightcove js in Require js module as bc.\n        loadBrightCoveJs(accountId, playerId);\n\n        require(['bc'], function() {\n            console.info(`Brightcove player js loaded...`);\n            const myPlayer = videojs.getPlayer(`brightcove-player-${playerId}`);\n            // Do meta loaded stuffs here.\n            console.info('Player meta data loaded...')\n            html5playerOnLoadMetaData(myPlayer);\n\n            // Do Start playing stuffs here.\n            html5playerOnPlay(myPlayer,course, cm, video_id)\n        });\n    }\n\n    return {\n       init: initBrightCovePlayer\n   }\n});"],"file":"brightcove.min.js"}